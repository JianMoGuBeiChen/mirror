{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shaku\\\\Documents\\\\React JS Apps\\\\Reflect\\\\src\\\\components\\\\FaceRecognitionService.jsx\",\n  _s = $RefreshSig$();\n// src/components/FaceRecognitionService.jsx\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport * as faceapi from 'face-api.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst PREVIEW_APP_ID = 'facerecognition_preview';\nconst FaceRecognitionService = ({\n  onFaceDetected,\n  settings = {},\n  enabled\n}) => {\n  _s();\n  var _ref;\n  const videoRef = useRef(null);\n  const canvasRef = useRef(null);\n  const [isEnabled, setIsEnabled] = useState((_ref = enabled !== null && enabled !== void 0 ? enabled : settings.enabled) !== null && _ref !== void 0 ? _ref : false);\n  const [showPreview, setShowPreview] = useState(settings.showPreview || false);\n  const [modelsLoaded, setModelsLoaded] = useState(false);\n  const [faceMatcher, setFaceMatcher] = useState(null);\n  const [previewPosition, setPreviewPosition] = useState({\n    x: 16,\n    y: 300\n  }); // Default position\n  const [isDraggingPreview, setIsDraggingPreview] = useState(false);\n  const [dragStart, setDragStart] = useState({\n    x: 0,\n    y: 0\n  });\n  const intervalRef = useRef(null);\n  useEffect(() => {\n    var _ref2;\n    setIsEnabled((_ref2 = enabled !== null && enabled !== void 0 ? enabled : settings.enabled) !== null && _ref2 !== void 0 ? _ref2 : false);\n    setShowPreview(settings.showPreview || false);\n  }, [enabled, settings]);\n\n  // Load models\n  useEffect(() => {\n    const loadModels = async () => {\n      const MODEL_URL = '/models';\n      try {\n        await Promise.all([faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL), faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL), faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL), faceapi.nets.ssdMobilenetv1.loadFromUri(MODEL_URL) // For loading reference image\n        ]);\n        setModelsLoaded(true);\n        console.log('FaceAPI models loaded');\n      } catch (e) {\n        console.error('Error loading face-api models:', e);\n      }\n    };\n    loadModels();\n  }, []);\n\n  // This function sets up the \"known faces\".\n  // In a real app, this would be dynamic, but here we'll hardcode one profile.\n  useEffect(() => {\n    if (!modelsLoaded) return;\n    const setupMatcher = async () => {\n      try {\n        // --- THIS IS THE \"ENROLLMENT\" STEP ---\n        // 1. Add a photo of yourself to the /public folder (e.g., /public/profile.jpg)\n        // 2. Give your name here\n        const name = 'Manan';\n        const referenceImage = await faceapi.fetchImage('/profile.jpg');\n        const detection = await faceapi.detectSingleFace(referenceImage).withFaceLandmarks().withFaceDescriptor();\n        if (!detection) {\n          console.error('Could not find a face in /profile.jpg. Enrollment failed.');\n          return;\n        }\n        const labeledDescriptor = new faceapi.LabeledFaceDescriptors(name, [detection.descriptor]);\n\n        // This matcher will be used to compare against the live video\n        setFaceMatcher(new faceapi.FaceMatcher(labeledDescriptor, 0.6)); // 0.6 is the distance threshold\n        console.log('Face matcher created for:', name);\n      } catch (e) {\n        console.error('Error creating face matcher:', e);\n      }\n    };\n    setupMatcher();\n  }, [modelsLoaded]);\n\n  // Start/stop camera\n  useEffect(() => {\n    if (!isEnabled || !modelsLoaded) {\n      // Stop video stream\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n        videoRef.current.srcObject = null;\n      }\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n        intervalRef.current = null;\n      }\n      onFaceDetected({\n        detected: false,\n        name: null\n      });\n      return;\n    }\n\n    // Start video stream\n    const startVideo = async () => {\n      try {\n        const stream = await navigator.mediaDevices.getUserMedia({\n          video: {\n            width: 640,\n            height: 480\n          }\n        });\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n        }\n      } catch (err) {\n        console.error('Error starting video stream:', err);\n      }\n    };\n    startVideo();\n\n    // Cleanup\n    return () => {\n      if (videoRef.current && videoRef.current.srcObject) {\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\n      }\n      if (intervalRef.current) {\n        clearInterval(intervalRef.current);\n      }\n    };\n  }, [isEnabled, modelsLoaded]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const handleVideoPlay = () => {\n    if (intervalRef.current) {\n      clearInterval(intervalRef.current);\n    }\n    // Start detection loop\n    intervalRef.current = setInterval(async () => {\n      if (!videoRef.current || videoRef.current.paused || videoRef.current.ended) {\n        return;\n      }\n      const canvas = canvasRef.current;\n      const video = videoRef.current;\n      if (!canvas || !video || !faceMatcher) return;\n      const displaySize = {\n        width: video.videoWidth,\n        height: video.videoHeight\n      };\n      faceapi.matchDimensions(canvas, displaySize);\n      const detections = await faceapi.detectAllFaces(video, new faceapi.TinyFaceDetectorOptions()).withFaceLandmarks().withFaceDescriptors();\n      const resizedDetections = faceapi.resizeResults(detections, displaySize);\n      const results = resizedDetections.map(d => faceMatcher.findBestMatch(d.descriptor));\n      const ctx = canvas.getContext('2d');\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\n      if (showPreview) {\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\n        faceapi.draw.drawDetections(canvas, resizedDetections);\n        faceapi.draw.drawFaceLandmarks(canvas, resizedDetections);\n      }\n      let detectedUser = null;\n      if (results.length > 0 && results[0].label !== 'unknown') {\n        detectedUser = results[0].label;\n        if (showPreview) {\n          // Draw the name\n          new faceapi.draw.DrawBox(resizedDetections[0].detection.box, {\n            label: detectedUser,\n            boxColor: 'rgba(0, 255, 0, 1)'\n          }).draw(canvas);\n        }\n      }\n      if (detectedUser) {\n        onFaceDetected({\n          detected: true,\n          name: detectedUser\n        });\n      } else {\n        onFaceDetected({\n          detected: false,\n          name: null\n        });\n      }\n    }, 500); // Run detection every 500ms\n  };\n\n  // --- Drag handlers (copied from HandTrackingService) ---\n  const handleMouseDown = e => {\n    setIsDraggingPreview(true);\n    setDragStart({\n      x: e.clientX - previewPosition.x,\n      y: e.clientY - previewPosition.y\n    });\n  };\n  const handleMouseMove = useCallback(e => {\n    if (isDraggingPreview) {\n      const newX = e.clientX - dragStart.x;\n      const newY = e.clientY - dragStart.y;\n      const maxX = window.innerWidth - 272;\n      const maxY = window.innerHeight - 200;\n      setPreviewPosition({\n        x: Math.max(0, Math.min(newX, maxX)),\n        y: Math.max(0, Math.min(newY, maxY))\n      });\n    }\n  }, [isDraggingPreview, dragStart]);\n  const handleMouseUp = useCallback(() => {\n    setIsDraggingPreview(false);\n    try {\n      const size = {\n        width: 256,\n        height: 192\n      };\n      const layout = {\n        position: {\n          ...previewPosition\n        },\n        size\n      };\n      localStorage.setItem(`smartMirror_${PREVIEW_APP_ID}_layout`, JSON.stringify(layout));\n      window.dispatchEvent(new Event('storage'));\n    } catch (_) {}\n  }, [previewPosition]);\n  useEffect(() => {\n    if (!isDraggingPreview) return;\n    document.addEventListener('mousemove', handleMouseMove);\n    document.addEventListener('mouseup', handleMouseUp);\n    return () => {\n      document.removeEventListener('mousemove', handleMouseMove);\n      document.removeEventListener('mouseup', handleMouseUp);\n    };\n  }, [isDraggingPreview, handleMouseMove, handleMouseUp]);\n  useEffect(() => {\n    try {\n      const saved = JSON.parse(localStorage.getItem(`smartMirror_${PREVIEW_APP_ID}_layout`) || 'null');\n      if (saved !== null && saved !== void 0 && saved.position) {\n        setPreviewPosition(saved.position);\n      }\n    } catch (_) {}\n  }, []);\n  // --- End of drag handlers ---\n\n  if (!isEnabled) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `absolute z-40 ${showPreview ? 'block' : 'hidden'}`,\n    style: {\n      left: `${previewPosition.x}px`,\n      top: `${previewPosition.y}px`\n    },\n    \"data-app-id\": PREVIEW_APP_ID,\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-black/80 backdrop-blur-sm rounded-lg p-2 cursor-move select-none\",\n      onMouseDown: handleMouseDown,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-white text-xs mb-2 text-center\",\n        children: \"Face Recognition Preview\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"relative\",\n        children: [/*#__PURE__*/_jsxDEV(\"video\", {\n          ref: videoRef,\n          className: \"hidden\",\n          playsInline: true,\n          autoPlay: true,\n          muted: true,\n          onPlay: handleVideoPlay,\n          width: \"640\",\n          height: \"480\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"canvas\", {\n          ref: canvasRef,\n          className: \"w-64 h-48 object-contain bg-black rounded\",\n          style: {\n            transform: 'scaleX(-1)' // Mirror the camera view\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 238,\n    columnNumber: 5\n  }, this);\n};\n_s(FaceRecognitionService, \"61kwW1WnqCtw7+SY/1NQ6y1BwuQ=\");\n_c = FaceRecognitionService;\nexport default FaceRecognitionService;\nvar _c;\n$RefreshReg$(_c, \"FaceRecognitionService\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","faceapi","jsxDEV","_jsxDEV","PREVIEW_APP_ID","FaceRecognitionService","onFaceDetected","settings","enabled","_s","_ref","videoRef","canvasRef","isEnabled","setIsEnabled","showPreview","setShowPreview","modelsLoaded","setModelsLoaded","faceMatcher","setFaceMatcher","previewPosition","setPreviewPosition","x","y","isDraggingPreview","setIsDraggingPreview","dragStart","setDragStart","intervalRef","_ref2","loadModels","MODEL_URL","Promise","all","nets","tinyFaceDetector","loadFromUri","faceLandmark68Net","faceRecognitionNet","ssdMobilenetv1","console","log","e","error","setupMatcher","name","referenceImage","fetchImage","detection","detectSingleFace","withFaceLandmarks","withFaceDescriptor","labeledDescriptor","LabeledFaceDescriptors","descriptor","FaceMatcher","current","srcObject","getTracks","forEach","track","stop","clearInterval","detected","startVideo","stream","navigator","mediaDevices","getUserMedia","video","width","height","err","handleVideoPlay","setInterval","paused","ended","canvas","displaySize","videoWidth","videoHeight","matchDimensions","detections","detectAllFaces","TinyFaceDetectorOptions","withFaceDescriptors","resizedDetections","resizeResults","results","map","d","findBestMatch","ctx","getContext","clearRect","drawImage","draw","drawDetections","drawFaceLandmarks","detectedUser","length","label","DrawBox","box","boxColor","handleMouseDown","clientX","clientY","handleMouseMove","newX","newY","maxX","window","innerWidth","maxY","innerHeight","Math","max","min","handleMouseUp","size","layout","position","localStorage","setItem","JSON","stringify","dispatchEvent","Event","_","document","addEventListener","removeEventListener","saved","parse","getItem","className","style","left","top","children","onMouseDown","fileName","_jsxFileName","lineNumber","columnNumber","ref","playsInline","autoPlay","muted","onPlay","transform","_c","$RefreshReg$"],"sources":["C:/Users/shaku/Documents/React JS Apps/Reflect/src/components/FaceRecognitionService.jsx"],"sourcesContent":["// src/components/FaceRecognitionService.jsx\r\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport * as faceapi from 'face-api.js';\r\n\r\nconst PREVIEW_APP_ID = 'facerecognition_preview';\r\n\r\nconst FaceRecognitionService = ({ onFaceDetected, settings = {}, enabled }) => {\r\n  const videoRef = useRef(null);\r\n  const canvasRef = useRef(null);\r\n  const [isEnabled, setIsEnabled] = useState(enabled ?? settings.enabled ?? false);\r\n  const [showPreview, setShowPreview] = useState(settings.showPreview || false);\r\n  const [modelsLoaded, setModelsLoaded] = useState(false);\r\n  const [faceMatcher, setFaceMatcher] = useState(null);\r\n  const [previewPosition, setPreviewPosition] = useState({ x: 16, y: 300 }); // Default position\r\n  const [isDraggingPreview, setIsDraggingPreview] = useState(false);\r\n  const [dragStart, setDragStart] = useState({ x: 0, y: 0 });\r\n  const intervalRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    setIsEnabled(enabled ?? settings.enabled ?? false);\r\n    setShowPreview(settings.showPreview || false);\r\n  }, [enabled, settings]);\r\n\r\n  // Load models\r\n  useEffect(() => {\r\n    const loadModels = async () => {\r\n      const MODEL_URL = '/models';\r\n      try {\r\n        await Promise.all([\r\n          faceapi.nets.tinyFaceDetector.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL),\r\n          faceapi.nets.faceRecognitionNet.loadFromUri(MODEL_URL),\r\n          faceapi.nets.ssdMobilenetv1.loadFromUri(MODEL_URL), // For loading reference image\r\n        ]);\r\n        setModelsLoaded(true);\r\n        console.log('FaceAPI models loaded');\r\n      } catch (e) {\r\n        console.error('Error loading face-api models:', e);\r\n      }\r\n    };\r\n    loadModels();\r\n  }, []);\r\n\r\n  // This function sets up the \"known faces\".\r\n  // In a real app, this would be dynamic, but here we'll hardcode one profile.\r\n  useEffect(() => {\r\n    if (!modelsLoaded) return;\r\n\r\n    const setupMatcher = async () => {\r\n      try {\r\n        // --- THIS IS THE \"ENROLLMENT\" STEP ---\r\n        // 1. Add a photo of yourself to the /public folder (e.g., /public/profile.jpg)\r\n        // 2. Give your name here\r\n        const name = 'Manan';\r\n        const referenceImage = await faceapi.fetchImage('/profile.jpg');\r\n\r\n        const detection = await faceapi\r\n          .detectSingleFace(referenceImage)\r\n          .withFaceLandmarks()\r\n          .withFaceDescriptor();\r\n          \r\n        if (!detection) {\r\n          console.error('Could not find a face in /profile.jpg. Enrollment failed.');\r\n          return;\r\n        }\r\n\r\n        const labeledDescriptor = new faceapi.LabeledFaceDescriptors(\r\n          name,\r\n          [detection.descriptor]\r\n        );\r\n        \r\n        // This matcher will be used to compare against the live video\r\n        setFaceMatcher(new faceapi.FaceMatcher(labeledDescriptor, 0.6)); // 0.6 is the distance threshold\r\n        console.log('Face matcher created for:', name);\r\n\r\n      } catch (e) {\r\n        console.error('Error creating face matcher:', e);\r\n      }\r\n    };\r\n\r\n    setupMatcher();\r\n  }, [modelsLoaded]);\r\n\r\n  // Start/stop camera\r\n  useEffect(() => {\r\n    if (!isEnabled || !modelsLoaded) {\r\n      // Stop video stream\r\n      if (videoRef.current && videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n        videoRef.current.srcObject = null;\r\n      }\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n      }\r\n      onFaceDetected({ detected: false, name: null });\r\n      return;\r\n    }\r\n\r\n    // Start video stream\r\n    const startVideo = async () => {\r\n      try {\r\n        const stream = await navigator.mediaDevices.getUserMedia({ video: { width: 640, height: 480 } });\r\n        if (videoRef.current) {\r\n          videoRef.current.srcObject = stream;\r\n        }\r\n      } catch (err) {\r\n        console.error('Error starting video stream:', err);\r\n      }\r\n    };\r\n\r\n    startVideo();\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (videoRef.current && videoRef.current.srcObject) {\r\n        videoRef.current.srcObject.getTracks().forEach(track => track.stop());\r\n      }\r\n      if (intervalRef.current) {\r\n        clearInterval(intervalRef.current);\r\n      }\r\n    };\r\n  }, [isEnabled, modelsLoaded]); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const handleVideoPlay = () => {\r\n    if (intervalRef.current) {\r\n      clearInterval(intervalRef.current);\r\n    }\r\n    // Start detection loop\r\n    intervalRef.current = setInterval(async () => {\r\n      if (!videoRef.current || videoRef.current.paused || videoRef.current.ended) {\r\n        return;\r\n      }\r\n\r\n      const canvas = canvasRef.current;\r\n      const video = videoRef.current;\r\n      if (!canvas || !video || !faceMatcher) return;\r\n\r\n      const displaySize = { width: video.videoWidth, height: video.videoHeight };\r\n      faceapi.matchDimensions(canvas, displaySize);\r\n\r\n      const detections = await faceapi\r\n        .detectAllFaces(video, new faceapi.TinyFaceDetectorOptions())\r\n        .withFaceLandmarks()\r\n        .withFaceDescriptors();\r\n\r\n      const resizedDetections = faceapi.resizeResults(detections, displaySize);\r\n      const results = resizedDetections.map(d => faceMatcher.findBestMatch(d.descriptor));\r\n\r\n      const ctx = canvas.getContext('2d');\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n\r\n      if (showPreview) {\r\n        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);\r\n        faceapi.draw.drawDetections(canvas, resizedDetections);\r\n        faceapi.draw.drawFaceLandmarks(canvas, resizedDetections);\r\n      }\r\n\r\n      let detectedUser = null;\r\n      if (results.length > 0 && results[0].label !== 'unknown') {\r\n        detectedUser = results[0].label;\r\n        if (showPreview) {\r\n          // Draw the name\r\n          new faceapi.draw.DrawBox(resizedDetections[0].detection.box, {\r\n            label: detectedUser,\r\n            boxColor: 'rgba(0, 255, 0, 1)'\r\n          }).draw(canvas);\r\n        }\r\n      }\r\n\r\n      if (detectedUser) {\r\n        onFaceDetected({ detected: true, name: detectedUser });\r\n      } else {\r\n        onFaceDetected({ detected: false, name: null });\r\n      }\r\n\r\n    }, 500); // Run detection every 500ms\r\n  };\r\n  \r\n  // --- Drag handlers (copied from HandTrackingService) ---\r\n  const handleMouseDown = (e) => {\r\n    setIsDraggingPreview(true);\r\n    setDragStart({\r\n      x: e.clientX - previewPosition.x,\r\n      y: e.clientY - previewPosition.y\r\n    });\r\n  };\r\n\r\n  const handleMouseMove = useCallback((e) => {\r\n    if (isDraggingPreview) {\r\n      const newX = e.clientX - dragStart.x;\r\n      const newY = e.clientY - dragStart.y;\r\n      const maxX = window.innerWidth - 272;\r\n      const maxY = window.innerHeight - 200;\r\n      setPreviewPosition({\r\n        x: Math.max(0, Math.min(newX, maxX)),\r\n        y: Math.max(0, Math.min(newY, maxY))\r\n      });\r\n    }\r\n  }, [isDraggingPreview, dragStart]);\r\n\r\n  const handleMouseUp = useCallback(() => {\r\n    setIsDraggingPreview(false);\r\n    try {\r\n      const size = { width: 256, height: 192 };\r\n      const layout = { position: { ...previewPosition }, size };\r\n      localStorage.setItem(`smartMirror_${PREVIEW_APP_ID}_layout`, JSON.stringify(layout));\r\n      window.dispatchEvent(new Event('storage'));\r\n    } catch (_) {}\r\n  }, [previewPosition]);\r\n\r\n  useEffect(() => {\r\n    if (!isDraggingPreview) return;\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n    return () => {\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, [isDraggingPreview, handleMouseMove, handleMouseUp]);\r\n\r\n  useEffect(() => {\r\n    try {\r\n      const saved = JSON.parse(localStorage.getItem(`smartMirror_${PREVIEW_APP_ID}_layout`) || 'null');\r\n      if (saved?.position) {\r\n        setPreviewPosition(saved.position);\r\n      }\r\n    } catch (_) {}\r\n  }, []);\r\n  // --- End of drag handlers ---\r\n\r\n\r\n  if (!isEnabled) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div \r\n      className={`absolute z-40 ${showPreview ? 'block' : 'hidden'}`}\r\n      style={{\r\n        left: `${previewPosition.x}px`,\r\n        top: `${previewPosition.y}px`\r\n      }}\r\n      data-app-id={PREVIEW_APP_ID}\r\n    >\r\n      <div \r\n        className=\"bg-black/80 backdrop-blur-sm rounded-lg p-2 cursor-move select-none\"\r\n        onMouseDown={handleMouseDown}\r\n      >\r\n        <div className=\"text-white text-xs mb-2 text-center\">Face Recognition Preview</div>\r\n        <div className=\"relative\">\r\n          <video\r\n            ref={videoRef}\r\n            className=\"hidden\"\r\n            playsInline\r\n            autoPlay\r\n            muted\r\n            onPlay={handleVideoPlay}\r\n            width=\"640\"\r\n            height=\"480\"\r\n          />\r\n          <canvas\r\n            ref={canvasRef}\r\n            className=\"w-64 h-48 object-contain bg-black rounded\"\r\n            style={{ \r\n              transform: 'scaleX(-1)', // Mirror the camera view\r\n            }}\r\n          />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FaceRecognitionService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}