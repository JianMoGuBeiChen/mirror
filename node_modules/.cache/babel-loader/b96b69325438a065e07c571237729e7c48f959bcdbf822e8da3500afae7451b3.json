{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shaku\\\\Documents\\\\React JS Apps\\\\Reflect\\\\src\\\\pages\\\\SmartMirror.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport { Link } from 'react-router-dom';\nimport DraggableApp from '../components/DraggableApp';\nimport CursorOverlay from '../components/CursorOverlay';\nimport HandTrackingService from '../components/HandTrackingService';\nimport FaceRecognitionService from '../components/FaceRecognitionService';\nimport { apps, getAppSettings } from '../data/apps';\nimport { getGeneralSettings } from '../data/general';\n\n// Import all app components\nimport ClockApp from '../apps/ClockApp';\nimport DateApp from '../apps/DateApp';\nimport WeatherApp from '../apps/WeatherApp';\nimport NewsApp from '../apps/NewsApp';\nimport SpotifyApp from '../apps/SpotifyApp';\nimport CalendarApp from '../apps/CalendarApp';\nimport TodoApp from '../apps/TodoApp';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SmartMirror = () => {\n  _s();\n  const [EnabledApps, setEnabledApps] = useState([]);\n  const containerRef = useRef(null);\n  const [cursorPosition, setCursorPosition] = useState({\n    x: 0,\n    y: 0,\n    detected: false\n  });\n  const [handTrackingEnabled, setHandTrackingEnabled] = useState(false);\n  const [faceRecognitionEnabled, setFaceRecognitionEnabled] = useState(false);\n  const [detectedUser, setDetectedUser] = useState(null);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragTarget, setDragTarget] = useState(null);\n  const dragTargetRef = useRef(null); // Immediate reference for drag logic\n  const [appPositions, setAppPositions] = useState({}); // Track positions for each app\n  const [focusedAppId, setFocusedAppId] = useState(null);\n  const [mirrorEnabled, setMirrorEnabled] = useState(getGeneralSettings().mirrorEnabled);\n  const clearDragState = () => {\n    // Clear all app highlights first\n    const allApps = document.querySelectorAll('[data-app-id]');\n    allApps.forEach(app => {\n      app.style.transition = '';\n      app.style.boxShadow = '';\n      app.style.transform = '';\n      app.style.zIndex = '';\n      app.style.pointerEvents = '';\n    });\n    setIsDragging(false);\n    setDragTarget(null);\n    dragTargetRef.current = null; // Clear ref immediately\n    // Don't clear appPositions here as they need to persist for the final save\n  };\n  useEffect(() => {\n    // Get enabled apps that are not background services\n    const getVisibleApps = () => {\n      const settings = JSON.parse(localStorage.getItem('smartMirrorSettings') || '{}');\n      return apps.filter(app => {\n        var _settings$app$id;\n        return !app.isBackgroundService &&\n        // Filter out background services\n        ((_settings$app$id = settings[app.id]) === null || _settings$app$id === void 0 ? void 0 : _settings$app$id.enabled) !== false;\n      });\n    };\n    setEnabledApps(getVisibleApps());\n\n    // Check if hand tracking is enabled\n    const handTrackingSettings = getAppSettings('handtracking');\n    setHandTrackingEnabled(handTrackingSettings.enabled || false);\n\n    // Check if face recognition is enabled\n    const faceRecognitionSettings = getAppSettings('facerecognition');\n    setFaceRecognitionEnabled(faceRecognitionSettings.enabled || false);\n\n    // Listen for settings changes\n    const handleStorageChange = () => {\n      setEnabledApps(getVisibleApps());\n      const updatedHandTrackingSettings = getAppSettings('handtracking');\n      setHandTrackingEnabled(updatedHandTrackingSettings.enabled || false);\n      const updatedFaceRecSettings = getAppSettings('facerecognition');\n      setFaceRecognitionEnabled(updatedFaceRecSettings.enabled || false);\n    };\n    window.addEventListener('storage', handleStorageChange);\n    const handleGeneral = () => setMirrorEnabled(getGeneralSettings().mirrorEnabled);\n    window.addEventListener('storage', handleGeneral);\n    return () => {\n      window.removeEventListener('storage', handleStorageChange);\n      window.removeEventListener('storage', handleGeneral);\n      // Clean up any drag state on unmount\n      clearDragState();\n    };\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const handleHandPosition = position => {\n    setCursorPosition(position);\n\n    // Always clear highlights when not pinching or hand not detected\n    if ((!position.isPinching || !position.detected) && !isDragging) {\n      clearDragState();\n    }\n\n    // Update hover focus for hand cursor\n    if (position.detected) {\n      const allApps = document.querySelectorAll('[data-app-id]');\n      let hoverAppId = null;\n      allApps.forEach(app => {\n        const rect = app.getBoundingClientRect();\n        const isUnderCursor = position.x >= rect.left && position.x <= rect.right && position.y >= rect.top && position.y <= rect.bottom;\n        if (isUnderCursor) hoverAppId = app.dataset.appId;\n      });\n      setFocusedAppId(hoverAppId);\n    } else {\n      setFocusedAppId(null);\n    }\n\n    // Handle pinch-to-drag functionality\n    if (position.detected && position.isPinching) {\n      if (!dragTargetRef.current) {\n        // Start dragging - find all apps and check which one is under cursor\n        const allApps = document.querySelectorAll('[data-app-id]');\n        let targetApp = null;\n        let highestZIndex = -1;\n        allApps.forEach(app => {\n          const rect = app.getBoundingClientRect();\n          const isUnderCursor = position.x >= rect.left && position.x <= rect.right && position.y >= rect.top && position.y <= rect.bottom;\n          if (isUnderCursor) {\n            const zIndex = parseInt(window.getComputedStyle(app).zIndex) || 0;\n            if (zIndex >= highestZIndex) {\n              highestZIndex = zIndex;\n              targetApp = app;\n            }\n          }\n        });\n        if (targetApp) {\n          var _containerRef$current;\n          // Clear any existing highlights\n          clearDragState();\n          setIsDragging(true);\n          const rect = targetApp.getBoundingClientRect();\n          const containerRect = (_containerRef$current = containerRef.current) === null || _containerRef$current === void 0 ? void 0 : _containerRef$current.getBoundingClientRect();\n          const dragTargetData = {\n            appId: targetApp.dataset.appId,\n            element: targetApp,\n            startX: position.x,\n            startY: position.y,\n            offsetX: position.x - rect.left,\n            offsetY: position.y - rect.top,\n            initialPosition: {\n              x: containerRect ? rect.left - containerRect.left : rect.left,\n              y: containerRect ? rect.top - containerRect.top : rect.top\n            }\n          };\n          setDragTarget(dragTargetData);\n          dragTargetRef.current = dragTargetData; // Set ref immediately\n\n          // Add visual feedback with lower z-index than cursor\n          targetApp.style.transition = 'none';\n          targetApp.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.8)';\n          targetApp.style.transform = 'none'; // NO TRANSFORM DURING DRAG - interferes with positioning\n          targetApp.style.zIndex = '1000'; // Still below cursor at 9999\n\n          // Force immediate position update to prevent lag\n          targetApp.style.pointerEvents = 'none';\n        }\n      } else {\n        var _containerRef$current2, _currentDragTarget$el, _currentDragTarget$el2;\n        const currentDragTarget = dragTargetRef.current;\n        // Continue dragging - calculate new position using React state\n        const containerRect = (_containerRef$current2 = containerRef.current) === null || _containerRef$current2 === void 0 ? void 0 : _containerRef$current2.getBoundingClientRect();\n        const appWidth = ((_currentDragTarget$el = currentDragTarget.element) === null || _currentDragTarget$el === void 0 ? void 0 : _currentDragTarget$el.offsetWidth) || 300;\n        const appHeight = ((_currentDragTarget$el2 = currentDragTarget.element) === null || _currentDragTarget$el2 === void 0 ? void 0 : _currentDragTarget$el2.offsetHeight) || 200;\n        const containerWidth = (containerRect === null || containerRect === void 0 ? void 0 : containerRect.width) || window.innerWidth;\n        const containerHeight = (containerRect === null || containerRect === void 0 ? void 0 : containerRect.height) || window.innerHeight;\n\n        // Calculate new position relative to the initial drag start\n        const deltaX = position.x - currentDragTarget.startX;\n        const deltaY = position.y - currentDragTarget.startY;\n        const newLeft = Math.max(0, Math.min(containerWidth - appWidth, currentDragTarget.initialPosition.x + deltaX));\n        const newTop = Math.max(0, Math.min(containerHeight - appHeight, currentDragTarget.initialPosition.y + deltaY));\n\n        // Update position in React state and force immediate DOM update\n        const newPosition = {\n          x: newLeft,\n          y: newTop\n        };\n        setAppPositions(prev => ({\n          ...prev,\n          [currentDragTarget.appId]: newPosition\n        }));\n\n        // Force immediate visual update to the DOM element for smoother dragging\n        if (currentDragTarget.element) {\n          currentDragTarget.element.style.left = `${newLeft}px`;\n          currentDragTarget.element.style.top = `${newTop}px`;\n        }\n      }\n    } else if (isDragging && dragTarget) {\n      var _dragTarget$element, _dragTarget$element2;\n      // Stop dragging\n\n      // Get final position from state\n      const finalPosition = appPositions[dragTarget.appId] || dragTarget.initialPosition;\n\n      // Save final position using the same key as DraggableApp\n      const layout = {\n        position: {\n          x: finalPosition.x,\n          y: finalPosition.y\n        },\n        size: {\n          width: ((_dragTarget$element = dragTarget.element) === null || _dragTarget$element === void 0 ? void 0 : _dragTarget$element.offsetWidth) || 300,\n          height: ((_dragTarget$element2 = dragTarget.element) === null || _dragTarget$element2 === void 0 ? void 0 : _dragTarget$element2.offsetHeight) || 200\n        }\n      };\n      localStorage.setItem(`smartMirror_${dragTarget.appId}_layout`, JSON.stringify(layout));\n      // Notify listeners in this tab\n      try {\n        window.dispatchEvent(new Event('storage'));\n      } catch (_) {}\n\n      // Clean up and reset state\n      clearDragState();\n    }\n  };\n  const handleFaceDetected = data => {\n    if (data.detected) {\n      setDetectedUser(data.name);\n    } else {\n      setDetectedUser(null);\n    }\n  };\n\n  // Component mapping\n  const componentMap = {\n    ClockApp,\n    DateApp,\n    WeatherApp,\n    NewsApp,\n    SpotifyApp,\n    CalendarApp,\n    TodoApp\n  };\n  const renderApp = app => {\n    const AppComponent = componentMap[app.componentPath];\n    if (!AppComponent) {\n      console.error(`Component not found: ${app.componentPath}`);\n      return null;\n    }\n    const isBeingDragged = isDragging && (dragTarget === null || dragTarget === void 0 ? void 0 : dragTarget.appId) === app.id;\n    const externalPosition = appPositions[app.id];\n    return /*#__PURE__*/_jsxDEV(DraggableApp, {\n      appId: app.id,\n      initialPosition: app.defaultPosition,\n      initialSize: app.defaultSize,\n      externalPosition: externalPosition,\n      isExternallyDragged: isBeingDragged,\n      isFocused: focusedAppId === app.id,\n      children: app.id === 'todo' ? /*#__PURE__*/_jsxDEV(AppComponent, {\n        appId: app.id,\n        detectedUser: detectedUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 268,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(AppComponent, {\n        appId: app.id\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 11\n      }, this)\n    }, app.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 7\n    }, this);\n  };\n  const publicApps = EnabledApps.filter(app => !app.isPersonal);\n  const personalApps = detectedUser ? EnabledApps.filter(app => app.isPersonal) : [];\n  const appsToRender = [...publicApps, ...personalApps];\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: containerRef,\n    className: `w-screen h-screen bg-black overflow-hidden relative`,\n    children: [/*#__PURE__*/_jsxDEV(Link, {\n      to: \"/settings\",\n      className: \"absolute top-4 right-4 z-50 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full p-3 transition-colors\",\n      children: /*#__PURE__*/_jsxDEV(\"svg\", {\n        className: \"w-6 h-6 text-white\",\n        fill: \"none\",\n        stroke: \"currentColor\",\n        viewBox: \"0 0 24 24\",\n        children: [/*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 288,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          strokeWidth: 2,\n          d: \"M15 12a3 3 0 11-6 0 3 3 0 016 0z\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 289,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(HandTrackingService, {\n      onHandPosition: handleHandPosition,\n      settings: getAppSettings('handtracking'),\n      enabled: handTrackingEnabled\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 294,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(FaceRecognitionService, {\n      onFaceDetected: handleFaceDetected,\n      settings: getAppSettings('facerecognition'),\n      enabled: faceRecognitionEnabled\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 7\n    }, this), detectedUser && !isDragging &&\n    /*#__PURE__*/\n    // Only show if not dragging\n    _jsxDEV(\"div\", {\n      className: \"absolute top-1/3 left-4 z-50 p-4 rounded-lg\",\n      style: {\n        textShadow: '0 2px 10px rgba(0,0,0,0.5)'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-4xl font-light text-white/80\",\n        children: \"Welcome,\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-6xl font-semibold text-white accent-text\",\n        children: detectedUser\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 309,\n      columnNumber: 9\n    }, this), mirrorEnabled ? appsToRender.map(renderApp) : null, /*#__PURE__*/_jsxDEV(CursorOverlay, {\n      position: cursorPosition,\n      isVisible: handTrackingEnabled && cursorPosition.detected,\n      isDragging: isDragging\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 7\n    }, this), appsToRender.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"absolute inset-0 flex items-center justify-center\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center text-white/70\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-6xl mb-4\",\n          children: \"\\uD83E\\uDE9F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-2xl mb-2\",\n          children: \"Smart Mirror\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-lg mb-4\",\n          children: \"No apps enabled\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/settings\",\n          className: \"bg-white/20 hover:bg-white/30 px-6 py-3 rounded-lg transition-colors\",\n          children: \"Go to Settings\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 339,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 335,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 334,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 281,\n    columnNumber: 5\n  }, this);\n};\n_s(SmartMirror, \"mwMHw3mEWuuPxe2MZAnFC5JdRgc=\");\n_c = SmartMirror;\nexport default SmartMirror;\nvar _c;\n$RefreshReg$(_c, \"SmartMirror\");","map":{"version":3,"names":["React","useState","useEffect","useRef","Link","DraggableApp","CursorOverlay","HandTrackingService","FaceRecognitionService","apps","getAppSettings","getGeneralSettings","ClockApp","DateApp","WeatherApp","NewsApp","SpotifyApp","CalendarApp","TodoApp","jsxDEV","_jsxDEV","SmartMirror","_s","EnabledApps","setEnabledApps","containerRef","cursorPosition","setCursorPosition","x","y","detected","handTrackingEnabled","setHandTrackingEnabled","faceRecognitionEnabled","setFaceRecognitionEnabled","detectedUser","setDetectedUser","isDragging","setIsDragging","dragTarget","setDragTarget","dragTargetRef","appPositions","setAppPositions","focusedAppId","setFocusedAppId","mirrorEnabled","setMirrorEnabled","clearDragState","allApps","document","querySelectorAll","forEach","app","style","transition","boxShadow","transform","zIndex","pointerEvents","current","getVisibleApps","settings","JSON","parse","localStorage","getItem","filter","_settings$app$id","isBackgroundService","id","enabled","handTrackingSettings","faceRecognitionSettings","handleStorageChange","updatedHandTrackingSettings","updatedFaceRecSettings","window","addEventListener","handleGeneral","removeEventListener","handleHandPosition","position","isPinching","hoverAppId","rect","getBoundingClientRect","isUnderCursor","left","right","top","bottom","dataset","appId","targetApp","highestZIndex","parseInt","getComputedStyle","_containerRef$current","containerRect","dragTargetData","element","startX","startY","offsetX","offsetY","initialPosition","_containerRef$current2","_currentDragTarget$el","_currentDragTarget$el2","currentDragTarget","appWidth","offsetWidth","appHeight","offsetHeight","containerWidth","width","innerWidth","containerHeight","height","innerHeight","deltaX","deltaY","newLeft","Math","max","min","newTop","newPosition","prev","_dragTarget$element","_dragTarget$element2","finalPosition","layout","size","setItem","stringify","dispatchEvent","Event","_","handleFaceDetected","data","name","componentMap","renderApp","AppComponent","componentPath","console","error","isBeingDragged","externalPosition","defaultPosition","initialSize","defaultSize","isExternallyDragged","isFocused","children","fileName","_jsxFileName","lineNumber","columnNumber","publicApps","isPersonal","personalApps","appsToRender","ref","className","to","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","onHandPosition","onFaceDetected","textShadow","map","isVisible","length","_c","$RefreshReg$"],"sources":["C:/Users/shaku/Documents/React JS Apps/Reflect/src/pages/SmartMirror.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport DraggableApp from '../components/DraggableApp';\r\nimport CursorOverlay from '../components/CursorOverlay';\r\nimport HandTrackingService from '../components/HandTrackingService';\r\nimport FaceRecognitionService from '../components/FaceRecognitionService';\r\nimport { apps, getAppSettings } from '../data/apps';\r\nimport { getGeneralSettings } from '../data/general';\r\n\r\n// Import all app components\r\nimport ClockApp from '../apps/ClockApp';\r\nimport DateApp from '../apps/DateApp';\r\nimport WeatherApp from '../apps/WeatherApp';\r\nimport NewsApp from '../apps/NewsApp';\r\nimport SpotifyApp from '../apps/SpotifyApp';\r\nimport CalendarApp from '../apps/CalendarApp';\r\nimport TodoApp from '../apps/TodoApp';\r\n\r\nconst SmartMirror = () => {\r\n  const [EnabledApps, setEnabledApps] = useState([]);\r\n  const containerRef = useRef(null);\r\n  const [cursorPosition, setCursorPosition] = useState({ x: 0, y: 0, detected: false });\r\n  const [handTrackingEnabled, setHandTrackingEnabled] = useState(false);\r\n  const [faceRecognitionEnabled, setFaceRecognitionEnabled] = useState(false);\r\n  const [detectedUser, setDetectedUser] = useState(null);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [dragTarget, setDragTarget] = useState(null);\r\n  const dragTargetRef = useRef(null); // Immediate reference for drag logic\r\n  const [appPositions, setAppPositions] = useState({}); // Track positions for each app\r\n  const [focusedAppId, setFocusedAppId] = useState(null);\r\n  const [mirrorEnabled, setMirrorEnabled] = useState(getGeneralSettings().mirrorEnabled);\r\n\r\n  const clearDragState = () => {\r\n    // Clear all app highlights first\r\n    const allApps = document.querySelectorAll('[data-app-id]');\r\n    allApps.forEach(app => {\r\n      app.style.transition = '';\r\n      app.style.boxShadow = '';\r\n      app.style.transform = '';\r\n      app.style.zIndex = '';\r\n      app.style.pointerEvents = '';\r\n    });\r\n    \r\n    setIsDragging(false);\r\n    setDragTarget(null);\r\n    dragTargetRef.current = null; // Clear ref immediately\r\n    // Don't clear appPositions here as they need to persist for the final save\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Get enabled apps that are not background services\r\n    const getVisibleApps = () => {\r\n      const settings = JSON.parse(localStorage.getItem('smartMirrorSettings') || '{}');\r\n      return apps.filter(app => \r\n        !app.isBackgroundService && // Filter out background services\r\n        settings[app.id]?.enabled !== false\r\n      );\r\n    };\r\n    \r\n    setEnabledApps(getVisibleApps());\r\n    \r\n    // Check if hand tracking is enabled\r\n    const handTrackingSettings = getAppSettings('handtracking');\r\n    setHandTrackingEnabled(handTrackingSettings.enabled || false);\r\n\r\n    // Check if face recognition is enabled\r\n    const faceRecognitionSettings = getAppSettings('facerecognition');\r\n    setFaceRecognitionEnabled(faceRecognitionSettings.enabled || false);\r\n    \r\n    // Listen for settings changes\r\n    const handleStorageChange = () => {\r\n      setEnabledApps(getVisibleApps());\r\n      const updatedHandTrackingSettings = getAppSettings('handtracking');\r\n      setHandTrackingEnabled(updatedHandTrackingSettings.enabled || false);\r\n\r\n      const updatedFaceRecSettings = getAppSettings('facerecognition');\r\n      setFaceRecognitionEnabled(updatedFaceRecSettings.enabled || false);\r\n    };\r\n    \r\n    window.addEventListener('storage', handleStorageChange);\r\n    const handleGeneral = () => setMirrorEnabled(getGeneralSettings().mirrorEnabled);\r\n    window.addEventListener('storage', handleGeneral);\r\n    return () => {\r\n      window.removeEventListener('storage', handleStorageChange);\r\n      window.removeEventListener('storage', handleGeneral);\r\n      // Clean up any drag state on unmount\r\n      clearDragState();\r\n    };\r\n  }, []); // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n  const handleHandPosition = (position) => {\r\n    setCursorPosition(position);\r\n    \r\n    // Always clear highlights when not pinching or hand not detected\r\n    if ((!position.isPinching || !position.detected) && !isDragging) {\r\n      clearDragState();\r\n    }\r\n    \r\n    // Update hover focus for hand cursor\r\n    if (position.detected) {\r\n      const allApps = document.querySelectorAll('[data-app-id]');\r\n      let hoverAppId = null;\r\n      allApps.forEach(app => {\r\n        const rect = app.getBoundingClientRect();\r\n        const isUnderCursor = position.x >= rect.left && \r\n                              position.x <= rect.right && \r\n                              position.y >= rect.top && \r\n                              position.y <= rect.bottom;\r\n        if (isUnderCursor) hoverAppId = app.dataset.appId;\r\n      });\r\n      setFocusedAppId(hoverAppId);\r\n    } else {\r\n      setFocusedAppId(null);\r\n    }\r\n\r\n    // Handle pinch-to-drag functionality\r\n    if (position.detected && position.isPinching) {\r\n      if (!dragTargetRef.current) {\r\n        // Start dragging - find all apps and check which one is under cursor\r\n        const allApps = document.querySelectorAll('[data-app-id]');\r\n        let targetApp = null;\r\n        let highestZIndex = -1;\r\n        \r\n        allApps.forEach(app => {\r\n          const rect = app.getBoundingClientRect();\r\n          const isUnderCursor = position.x >= rect.left && \r\n                               position.x <= rect.right && \r\n                               position.y >= rect.top && \r\n                               position.y <= rect.bottom;\r\n          \r\n          if (isUnderCursor) {\r\n            const zIndex = parseInt(window.getComputedStyle(app).zIndex) || 0;\r\n            if (zIndex >= highestZIndex) {\r\n              highestZIndex = zIndex;\r\n              targetApp = app;\r\n            }\r\n          }\r\n        });\r\n        \r\n        if (targetApp) {\r\n          // Clear any existing highlights\r\n          clearDragState();\r\n          \r\n          setIsDragging(true);\r\n          const rect = targetApp.getBoundingClientRect();\r\n          const containerRect = containerRef.current?.getBoundingClientRect();\r\n          \r\n          const dragTargetData = {\r\n            appId: targetApp.dataset.appId,\r\n            element: targetApp,\r\n            startX: position.x,\r\n            startY: position.y,\r\n            offsetX: position.x - rect.left,\r\n            offsetY: position.y - rect.top,\r\n            initialPosition: {\r\n              x: containerRect ? rect.left - containerRect.left : rect.left,\r\n              y: containerRect ? rect.top - containerRect.top : rect.top\r\n            }\r\n          };\r\n          \r\n          setDragTarget(dragTargetData);\r\n          dragTargetRef.current = dragTargetData; // Set ref immediately\r\n          \r\n          // Add visual feedback with lower z-index than cursor\r\n          targetApp.style.transition = 'none';\r\n          targetApp.style.boxShadow = '0 0 20px rgba(59, 130, 246, 0.8)';\r\n          targetApp.style.transform = 'none'; // NO TRANSFORM DURING DRAG - interferes with positioning\r\n          targetApp.style.zIndex = '1000'; // Still below cursor at 9999\r\n          \r\n          // Force immediate position update to prevent lag\r\n          targetApp.style.pointerEvents = 'none';\r\n        }\r\n      } else {\r\n        const currentDragTarget = dragTargetRef.current;\r\n        // Continue dragging - calculate new position using React state\r\n        const containerRect = containerRef.current?.getBoundingClientRect();\r\n        const appWidth = currentDragTarget.element?.offsetWidth || 300;\r\n        const appHeight = currentDragTarget.element?.offsetHeight || 200;\r\n        const containerWidth = containerRect?.width || window.innerWidth;\r\n        const containerHeight = containerRect?.height || window.innerHeight;\r\n\r\n        // Calculate new position relative to the initial drag start\r\n        const deltaX = position.x - currentDragTarget.startX;\r\n        const deltaY = position.y - currentDragTarget.startY;\r\n        \r\n        const newLeft = Math.max(0, Math.min(containerWidth - appWidth, currentDragTarget.initialPosition.x + deltaX));\r\n        const newTop = Math.max(0, Math.min(containerHeight - appHeight, currentDragTarget.initialPosition.y + deltaY));\r\n        \r\n        // Update position in React state and force immediate DOM update\r\n        const newPosition = { x: newLeft, y: newTop };\r\n        \r\n        setAppPositions(prev => ({\r\n          ...prev,\r\n          [currentDragTarget.appId]: newPosition\r\n        }));\r\n        \r\n        // Force immediate visual update to the DOM element for smoother dragging\r\n        if (currentDragTarget.element) {\r\n          currentDragTarget.element.style.left = `${newLeft}px`;\r\n          currentDragTarget.element.style.top = `${newTop}px`;\r\n        }\r\n      }\r\n    } else if (isDragging && dragTarget) {\r\n      // Stop dragging\r\n      \r\n      // Get final position from state\r\n      const finalPosition = appPositions[dragTarget.appId] || dragTarget.initialPosition;\r\n      \r\n      // Save final position using the same key as DraggableApp\r\n      const layout = {\r\n        position: { x: finalPosition.x, y: finalPosition.y },\r\n        size: { \r\n          width: dragTarget.element?.offsetWidth || 300, \r\n          height: dragTarget.element?.offsetHeight || 200\r\n        }\r\n      };\r\n      localStorage.setItem(`smartMirror_${dragTarget.appId}_layout`, JSON.stringify(layout));\r\n      // Notify listeners in this tab\r\n      try { window.dispatchEvent(new Event('storage')); } catch (_) {}\r\n      \r\n      // Clean up and reset state\r\n      clearDragState();\r\n    }\r\n  };\r\n\r\n  const handleFaceDetected = (data) => {\r\n    if (data.detected) {\r\n      setDetectedUser(data.name);\r\n    } else {\r\n      setDetectedUser(null);\r\n    }\r\n  };\r\n\r\n  // Component mapping\r\n  const componentMap = {\r\n    ClockApp,\r\n    DateApp,\r\n    WeatherApp,\r\n    NewsApp,\r\n    SpotifyApp,\r\n    CalendarApp,\r\n    TodoApp,\r\n  };\r\n\r\n  const renderApp = (app) => {\r\n    const AppComponent = componentMap[app.componentPath];\r\n    \r\n    if (!AppComponent) {\r\n      console.error(`Component not found: ${app.componentPath}`);\r\n      return null;\r\n    }\r\n\r\n    const isBeingDragged = isDragging && dragTarget?.appId === app.id;\r\n    const externalPosition = appPositions[app.id];\r\n\r\n    return (\r\n      <DraggableApp\r\n        key={app.id}\r\n        appId={app.id}\r\n        initialPosition={app.defaultPosition}\r\n        initialSize={app.defaultSize}\r\n        externalPosition={externalPosition}\r\n        isExternallyDragged={isBeingDragged}\r\n        isFocused={focusedAppId === app.id}\r\n      >\r\n      {/* --- Pass detectedUser to TodoApp --- */}\r\n        {app.id === 'todo' ? (\r\n          <AppComponent appId={app.id} detectedUser={detectedUser} />\r\n        ) : (\r\n          <AppComponent appId={app.id} />\r\n        )}\r\n      </DraggableApp>\r\n    );\r\n  };\r\n\r\n  const publicApps = EnabledApps.filter(app => !app.isPersonal);\r\n  const personalApps = detectedUser ? EnabledApps.filter(app => app.isPersonal) : [];\r\n  const appsToRender = [...publicApps, ...personalApps];\r\n\r\n  return (\r\n    <div ref={containerRef} className={`w-screen h-screen bg-black overflow-hidden relative`}>\r\n      {/* Settings Button */}\r\n      <Link \r\n        to=\"/settings\"\r\n        className=\"absolute top-4 right-4 z-50 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full p-3 transition-colors\"\r\n      >\r\n        <svg className=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z\" />\r\n          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n        </svg>\r\n      </Link>\r\n\r\n      {/* Background Hand Tracking Service */}\r\n      <HandTrackingService \r\n        onHandPosition={handleHandPosition}\r\n        settings={getAppSettings('handtracking')}\r\n        enabled={handTrackingEnabled}\r\n      />\r\n      \r\n      {/* BACKGROUND FACE RECOGNITION SERVICE */}\r\n      <FaceRecognitionService\r\n        onFaceDetected={handleFaceDetected}\r\n        settings={getAppSettings('facerecognition')}\r\n        enabled={faceRecognitionEnabled}\r\n      />\r\n\r\n      {/* Welcome Message */}\r\n      {detectedUser && !isDragging && ( // Only show if not dragging\r\n        <div \r\n          className=\"absolute top-1/3 left-4 z-50 p-4 rounded-lg\"\r\n          style={{ textShadow: '0 2px 10px rgba(0,0,0,0.5)' }}\r\n        >\r\n          <div className=\"text-4xl font-light text-white/80\">\r\n            Welcome,\r\n          </div>\r\n          <div className=\"text-6xl font-semibold text-white accent-text\">\r\n            {detectedUser}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Render enabled apps or black screen when mirror disabled */}\r\n      {mirrorEnabled ? appsToRender.map(renderApp) : null}\r\n\r\n      {/* Hand tracking cursor overlay */}\r\n      <CursorOverlay \r\n        position={cursorPosition} \r\n        isVisible={handTrackingEnabled && cursorPosition.detected}\r\n        isDragging={isDragging}\r\n      />\r\n\r\n      {/* Instructions overlay (only show if no apps are enabled) */}\r\n      {appsToRender.length === 0 && (\r\n        <div className=\"absolute inset-0 flex items-center justify-center\">\r\n          <div className=\"text-center text-white/70\">\r\n            <div className=\"text-6xl mb-4\">🪟</div>\r\n            <div className=\"text-2xl mb-2\">Smart Mirror</div>\r\n            <div className=\"text-lg mb-4\">No apps enabled</div>\r\n            <Link \r\n              to=\"/settings\"\r\n              className=\"bg-white/20 hover:bg-white/30 px-6 py-3 rounded-lg transition-colors\"\r\n            >\r\n              Go to Settings\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SmartMirror;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}